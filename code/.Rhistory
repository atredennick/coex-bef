####  READ IN ANNUAL PLANT DATA
####
species_year_data <- read.csv("../data/species_x_year.csv")
single_spp_data <- subset(species_year_data, species==do_species)
####
####  SIMULATE LONG-TERM PER CAPITA GROWTH RATE
####
single_spp_data <- subset(single_spp_data, germ.fraction!="." & lxbx!=".")
seeds_per_seedling_vec <- as.numeric(as.character(single_spp_data$lxbx))
seed_surv <- nongerm_seed_surv <- 0.1
germination_frac_vec <- as.numeric(as.character(single_spp_data$germ.fraction))
iters <- 1000
pgr <- numeric(iters)
germ_fracs <- seq(0,1,0.01)
geom_mean <- numeric(length(germ_fracs))
arith_mean <- numeric(length(germ_fracs))
count <- 1
gm_mean = function(x, na.rm=TRUE){
exp(sum(log(x[x > 0]), na.rm=na.rm) / length(x))
}
random_years <- sample(c(1:length(seeds_per_seedling_vec)), iters, replace = TRUE)
for(germ in germ_fracs){
for(t in 1:iters){
randyr <- random_years[t]
pgr[t] <- project_popmod(seed_surv = seed_surv,
seeds_per_seedling = seeds_per_seedling_vec[randyr],
germination_frac = germ,
nongerm_seed_surv = nongerm_seed_surv)
}
geom_mean[count] <- gm_mean(pgr)
arith_mean[count] <- log(mean(pgr[pgr>0]))
count <- count+1
}
par(mfrow=c(1,2))
plot(germ_fracs, geom_mean, type="l")
plot(germ_fracs, arith_mean, type="l")
####################################################################
##  wintann_pop_model.R: simulates long term population dynamics  ##
##  of species in a Sonoran Desert winter annual plant community. ##
##  The model is a generic annual plant model with seedbank.      ##
####################################################################
# Clear the workspace
rm(list=ls(all.names = TRUE))
# Load some libraries
library(plyr)
library(reshape2)
library(ggthemes)
library(ggplot2)
do_species <- "erla"
####
####  ANNUAL PLANT POPULATION MODEL -- DENSITY-INDEPENDENT
####
# From Gremer and Venable 2014 (Ecology Letters)
project_popmod <- function(seed_surv, seeds_per_seedling, germination_frac, nongerm_seed_surv)
{
pgr <- seeds_per_seedling*germination_frac*seed_surv + nongerm_seed_surv*seed_surv*(1-germination_frac)
}
####
####  READ IN ANNUAL PLANT DATA
####
species_year_data <- read.csv("../data/species_x_year.csv")
single_spp_data <- subset(species_year_data, species==do_species)
####
####  SIMULATE LONG-TERM PER CAPITA GROWTH RATE
####
single_spp_data <- subset(single_spp_data, germ.fraction!="." & lxbx!=".")
seeds_per_seedling_vec <- as.numeric(as.character(single_spp_data$lxbx))
seed_surv <- nongerm_seed_surv <- 0.1
germination_frac_vec <- as.numeric(as.character(single_spp_data$germ.fraction))
iters <- 1000
pgr <- numeric(iters)
germ_fracs <- seq(0,1,0.01)
geom_mean <- numeric(length(germ_fracs))
arith_mean <- numeric(length(germ_fracs))
count <- 1
gm_mean = function(x, na.rm=TRUE){
exp(sum(log(x[x > 0]), na.rm=na.rm) / length(x))
}
random_years <- sample(c(1:length(seeds_per_seedling_vec)), iters, replace = TRUE)
for(germ in germ_fracs){
for(t in 1:iters){
randyr <- random_years[t]
pgr[t] <- project_popmod(seed_surv = seed_surv,
seeds_per_seedling = seeds_per_seedling_vec[randyr],
germination_frac = germ,
nongerm_seed_surv = nongerm_seed_surv)
}
geom_mean[count] <- gm_mean(pgr)
arith_mean[count] <- log(mean(pgr[pgr>0]))
count <- count+1
}
par(mfrow=c(1,2))
plot(germ_fracs, geom_mean, type="l")
plot(germ_fracs, arith_mean, type="l")
####################################################################
##  wintann_pop_model.R: simulates long term population dynamics  ##
##  of species in a Sonoran Desert winter annual plant community. ##
##  The model is a generic annual plant model with seedbank.      ##
####################################################################
# Clear the workspace
rm(list=ls(all.names = TRUE))
# Load some libraries
library(plyr)
library(reshape2)
library(ggthemes)
library(ggplot2)
do_species <- "erla"
####
####  ANNUAL PLANT POPULATION MODEL -- DENSITY-INDEPENDENT
####
# From Gremer and Venable 2014 (Ecology Letters)
project_popmod <- function(seed_surv_old, seed_surv_new, seeds_per_seedling,
germination_frac, nongerm_seed_surv)
{
pgr <- seeds_per_seedling*germination_frac*seed_surv_new + nongerm_seed_surv*seed_surv_old*(1-germination_frac)
}
####
####  READ IN ANNUAL PLANT DATA
####
species_year_data <- read.csv("../data/species_x_year.csv")
single_spp_data <- subset(species_year_data, species==do_species)
####
####  SIMULATE LONG-TERM PER CAPITA GROWTH RATE
####
single_spp_data <- subset(single_spp_data, germ.fraction!="." & lxbx!=".")
seeds_per_seedling_vec <- as.numeric(as.character(single_spp_data$lxbx))
seed_surv_new <- 0.153
seed_surv_old <- 0.56
nongerm_seed_surv <- 0.823
germination_frac_vec <- as.numeric(as.character(single_spp_data$germ.fraction))
iters <- 1000
pgr <- numeric(iters)
germ_fracs <- seq(0,1,0.01)
geom_mean <- numeric(length(germ_fracs))
arith_mean <- numeric(length(germ_fracs))
count <- 1
gm_mean = function(x, na.rm=TRUE){
exp(sum(log(x[x > 0]), na.rm=na.rm) / length(x))
}
random_years <- sample(c(1:length(seeds_per_seedling_vec)), iters, replace = TRUE)
for(germ in germ_fracs){
for(t in 1:iters){
randyr <- random_years[t]
pgr[t] <- project_popmod(seed_surv_old = seed_surv_old,
seed_surv_new = seed_surv_new,
seeds_per_seedling = seeds_per_seedling_vec[randyr],
germination_frac = germ,
nongerm_seed_surv = nongerm_seed_surv)
}
geom_mean[count] <- gm_mean(pgr)
arith_mean[count] <- log(mean(pgr[pgr>0]))
count <- count+1
}
par(mfrow=c(1,2))
plot(germ_fracs, geom_mean, type="l")
plot(germ_fracs, arith_mean, type="l")
count
plot(germ_fracs, geom_mean, type="l", xlim=c(0,0.99))
plot(germ_fracs, geom_mean, type="l", xlim=c(0,0.9))
plot(germ_fracs, geom_mean, type="l", xlim=c(0,0.95))
plot(germ_fracs, geom_mean, type="l", xlim=c(0,1))
pgr
####################################################################
##  wintann_pop_model.R: simulates long term population dynamics  ##
##  of species in a Sonoran Desert winter annual plant community. ##
##  The model is a generic annual plant model with seedbank.      ##
####################################################################
# Clear the workspace
rm(list=ls(all.names = TRUE))
# Load some libraries
library(plyr)
library(reshape2)
library(ggthemes)
library(ggplot2)
do_species <- "erla"
####
####  ANNUAL PLANT POPULATION MODEL -- DENSITY-INDEPENDENT
####
# From Gremer and Venable 2014 (Ecology Letters)
project_popmod <- function(seed_surv_old, seed_surv_new, seeds_per_seedling,
germination_frac, nongerm_seed_surv)
{
pgr <- seeds_per_seedling*germination_frac*seed_surv_new + nongerm_seed_surv*seed_surv_old*(1-germination_frac)
}
####
####  READ IN ANNUAL PLANT DATA
####
species_year_data <- read.csv("../data/species_x_year.csv")
single_spp_data <- subset(species_year_data, species==do_species)
####
####  SIMULATE LONG-TERM PER CAPITA GROWTH RATE
####
single_spp_data <- subset(single_spp_data, germ.fraction!="." & lxbx!=".")
seeds_per_seedling_vec <- as.numeric(as.character(single_spp_data$lxbx))
seed_surv_new <- 0.153
seed_surv_old <- 0.56
nongerm_seed_surv <- 0.823
germination_frac_vec <- as.numeric(as.character(single_spp_data$germ.fraction))
iters <- 1000
pgr <- numeric(iters)
germ_fracs <- seq(0,1,0.01)
geom_mean <- numeric(length(germ_fracs))
arith_mean <- numeric(length(germ_fracs))
count <- 1
gm_mean = function(x, na.rm=TRUE){
exp(sum(log(x[x > 0]), na.rm=na.rm) / length(x))
}
random_years <- sample(c(1:length(seeds_per_seedling_vec)), iters, replace = TRUE)
for(germ in germ_fracs){
for(t in 1:iters){
randyr <- random_years[t]
pgr[t] <- project_popmod(seed_surv_old = seed_surv_old,
seed_surv_new = seed_surv_new,
seeds_per_seedling = seeds_per_seedling_vec[randyr],
germination_frac = germ,
nongerm_seed_surv = nongerm_seed_surv)
}
geom_mean[count] <- gm_mean(pgr)
arith_mean[count] <- log(mean(pgr[pgr>0]))
count <- count+1
}
par(mfrow=c(1,2))
plot(germ_fracs, geom_mean, type="l")
plot(germ_fracs, arith_mean, type="l")
plot(germ_fracs, geom_mean, type="l", main=do_species)
plot(germ_fracs, arith_mean, type="l", main=do_species)
#################################################################
##  explore_wintann_data.R: R script to explore Sonoran Desert ##
##  winter annual demographic dataset                          ##
#################################################################
# Clear the workspace
rm(list=ls(all.names = TRUE))
# Load some libraries
library(plyr)
library(reshape2)
library(ggthemes)
library(ggplot2)
####
####  LOAD SEED BANK DATA
####
seed_bank <- read.csv("../data/Seed_Bank.csv")
head(seed_bank)
#################################################################
##  explore_wintann_data.R: R script to explore Sonoran Desert ##
##  winter annual demographic dataset                          ##
#################################################################
# Clear the workspace
rm(list=ls(all.names = TRUE))
# Load some libraries
library(plyr)
library(reshape2)
library(ggthemes)
library(ggplot2)
####
####  LOAD SEED BANK DATA
####
seed_bank <- read.csv("../data/Seed_Bank.csv")
ggplot(seed_bank, aes(x=year, y=viable.seeds,color=plot))+
geom_line()+
facet_grid(species~replicate)
# Summarise data by species and year
avg_seed_bank <- ddply(seed_bank, .(year, species), summarise,
viable_seeds = mean(viable.seeds))
head(avg_seed_bank)
ggplot(seed_bank, aes(x=year, y=viable.seeds, color=species))+
geom_line()
ggplot(seed_bank, aes(x=as.character(year), y=viable.seeds, color=species))+
geom_line()
ggplot(avg_seed_bank, aes(x=year, y=viable.seeds, color=species))+
geom_line()
ggplot(avg_seed_bank, aes(x=year, y=viable_seeds, color=species))+
geom_line()
summary(avg_seed_bank)
summary(seed_bank)
head(seed_bank)
#################################################################
##  explore_wintann_data.R: R script to explore Sonoran Desert ##
##  winter annual demographic dataset                          ##
#################################################################
# Clear the workspace
rm(list=ls(all.names = TRUE))
# Load some libraries
library(plyr)
library(reshape2)
library(ggthemes)
library(ggplot2)
####
####  LOAD SEED BANK DATA
####
seed_bank <- read.csv("../data/Seed_Bank.csv")
seed_bank <- subset(seed_bank, viable.seeds!=-99)
# Summarise data by species and year
avg_seed_bank <- ddply(seed_bank, .(year, species), summarise,
viable_seeds = mean(viable.seeds))
ggplot(avg_seed_bank, aes(x=year, y=viable_seeds, color=species))+
geom_line()
#################################################################
##  explore_wintann_data.R: R script to explore Sonoran Desert ##
##  winter annual demographic dataset                          ##
#################################################################
# Clear the workspace
rm(list=ls(all.names = TRUE))
# Load some libraries
library(plyr)
library(reshape2)
library(ggthemes)
library(ggplot2)
####
####  LOAD SEED BANK DATA
####
seed_bank <- read.csv("../data/Seed_Bank.csv")
seed_bank <- subset(seed_bank, viable.seeds!=-99)
# Summarise data by species and year
avg_seed_bank <- ddply(seed_bank, .(year, species), summarise,
viable_seeds = mean(viable.seeds))
ggplot(avg_seed_bank, aes(x=year, y=viable_seeds, color=species))+
geom_line()
# Plot time series for abundant species from Gremer and Venable
gremer_species <- c("erla", "erci", "erte", "evmu", "mobe", "pehe", "pere",
"plpa", "plin", "scba", "stmi", "vuoc")
gremer_species <- c(gremer_species, toupper(gremer_species))
abundant_seeds <- avg_seed_bank[which(avg_seed_bank$species %in% gremer_species),]
ggplot(abundant_seeds, aes(x=year, y=viable_seeds, color=species))+
geom_line()
#################################################################
##  explore_wintann_data.R: R script to explore Sonoran Desert ##
##  winter annual demographic dataset                          ##
#################################################################
# Clear the workspace
rm(list=ls(all.names = TRUE))
# Load some libraries
library(plyr)
library(reshape2)
library(ggthemes)
library(ggplot2)
####
####  LOAD SEED BANK DATA
####
seed_bank <- read.csv("../data/Seed_Bank.csv")
seed_bank <- subset(seed_bank, viable.seeds!=-99)
seed_bank$species <- tolower(seed_bank$species)
# Summarise data by species and year
avg_seed_bank <- ddply(seed_bank, .(year, species), summarise,
viable_seeds = mean(viable.seeds))
ggplot(avg_seed_bank, aes(x=year, y=viable_seeds, color=species))+
geom_line()
# Plot time series for abundant species from Gremer and Venable
gremer_species <- c("erla", "erci", "erte", "evmu", "mobe", "pehe", "pere",
"plpa", "plin", "scba", "stmi", "vuoc")
abundant_seeds <- avg_seed_bank[which(avg_seed_bank$species %in% gremer_species),]
ggplot(abundant_seeds, aes(x=year, y=viable_seeds, color=species))+
geom_line()
ggplot(abundant_seeds, aes(x=year, y=viable_seeds, color=species))+
geom_line()+
geom_point()
ggplot(abundant_seeds, aes(x=year, y=viable_seeds, color=species))+
geom_line(alpha=0.5)+
geom_point()
head(seed_bank)
census_data <- read.csv("../data/census_data.csv")
head(census_data)
abund_per_plot <- ddply(census_data, .(Year, plot.habitat.replicate, species), summarise
abundance = length(seeds))
census_data <- read.csv("../data/census_data.csv")
census_data$species <- tolower(census_data$species)
# Summarise data to get average abundance per year
abund_per_plot <- ddply(census_data, .(Year, plot.habitat.replicate, species), summarise,
abundance = length(seeds))
head(abund_per_plot)
avg_abundance <- ddply(abund_per_plot, .(Year, species), summarise,
mean_abundance = mean(abundance))
####
####  LOAD INDIVIDUAL CENSUS DATA
####
census_data <- read.csv("../data/census_data.csv")
census_data$species <- tolower(census_data$species)
# Summarise data to get average abundance per year
abund_per_plot <- ddply(census_data, .(Year, plot.habitat.replicate, species), summarise,
abundance = length(seeds))
avg_abundance <- ddply(abund_per_plot, .(Year, species), summarise,
mean_abundance = mean(abundance))
# Plot abundance species only
abundant_abundance <- avg_abundance[which(avg_abundance$species %in% gremer_species),]
ggplot(abundant_abundance, aes(x=Year, y=abundance))+
geom_line()+
geom_point()
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance))+
geom_line()+
geom_point()
haed(abundant_abundance)
head(abundant_abundance)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line()+
geom_point()
ggplot(abundant_abundance, aes(x=Year, y=log(mean_abundance), color=species))+
geom_line()+
geom_point()
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line()+
geom_point()
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
theme_few()+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
theme_bw()+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=as.character(Year), y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
theme_bw()+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=as.factor(Year), y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
theme_bw()+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
scale_y_continuous(values=unique(abundant_abundance$Year))+
theme_bw()+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
scale_y_manual(values=unique(abundant_abundance$Year))+
theme_bw()+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
scale_x_continuous(values=unique(abundant_abundance$Year))+
theme_bw()+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
scale_x_continuous(breaks=unique(abundant_abundance$Year))+
theme_bw()+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
scale_x_continuous(breaks=unique(abundant_abundance$Year))+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
scale_x_continuous(breaks=unique(abundant_abundance$Year))+
ylab("Average Seedling Abundance")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
guides(color=FALSE)
total_abundance <- ddply(abundant_abundance, .(Year), summarise,
abundance = sum(mean_abundance))
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
geom_line(data=total_abundance, aes(x=Year, y=abundance), size=3)+
scale_x_continuous(breaks=unique(abundant_abundance$Year))+
ylab("Average Seedling Abundance")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
geom_line(data=total_abundance, aes(x=Year, y=abundance), color="black", size=3)+
scale_x_continuous(breaks=unique(abundant_abundance$Year))+
ylab("Average Seedling Abundance")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
geom_line(data=total_abundance, aes(x=Year, y=abundance), color="black", size=1)+
scale_x_continuous(breaks=unique(abundant_abundance$Year))+
ylab("Average Seedling Abundance")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
geom_line(data=total_abundance, aes(x=Year, y=abundance), color="black", size=1, alpha=0.5)+
geom_point(data=total_abundance, aes(x=Year, y=abundance), color="black", size=1)+
scale_x_continuous(breaks=unique(abundant_abundance$Year))+
ylab("Average Seedling Abundance")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
guides(color=FALSE)
ggplot(abundant_abundance, aes(x=Year, y=mean_abundance, color=species))+
geom_line(alpha=0.5)+
geom_point()+
geom_line(data=total_abundance, aes(x=Year, y=abundance), color="black", size=1, alpha=0.5)+
geom_point(data=total_abundance, aes(x=Year, y=abundance), color="black", size=3)+
scale_x_continuous(breaks=unique(abundant_abundance$Year))+
ylab("Average Seedling Abundance")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
guides(color=FALSE)
cv_abundance <- sd(total_abundance$abundance) / mean(total_abundance$abundance)
cv_abundance
source('~/Repos/coex-bef/code/wintann_pop_model.R', echo=TRUE)
geom_mean
